import{S as e,_ as t,c as n,d as r,f as i,g as a,m as o,n as s,o as c,p as l,r as u,s as d,t as f,u as ee,v as p,x as m,y as h}from"./index-CNeS0yFr.js";var g={class:`knowledge-base-container`},_={class:`kb-header`},v={class:`header-actions`},y={class:`kb-list`},b={class:`kb-name`},x={class:`dialog-footer`},S={class:`dialog-footer`},C={class:`kb-detail-content`},w={class:`kb-info`},T={class:`kb-description`},E={class:`kb-meta`},te={class:`documents-list`},D=f(l({__name:`KnowledgeBase`,setup(e){let l=h([{id:`kb_001`,name:`水预算基础理论`,description:`包含水预算的基本概念、计算方法和应用案例`,domain:`hydrology`,documentCount:5,status:`enabled`,createTime:`2026-01-08 10:30:00`,updateTime:`2026-01-08 14:20:00`},{id:`kb_002`,name:`水资源管理技术`,description:`水资源规划、配置和管理的技术方法和实践经验`,domain:`water_resources`,documentCount:8,status:`enabled`,createTime:`2026-01-07 09:15:00`,updateTime:`2026-01-07 16:45:00`},{id:`kb_003`,name:`水环境监测标准`,description:`水环境监测的标准规范和技术要求`,domain:`water_environment`,documentCount:3,status:`disabled`,createTime:`2026-01-06 11:20:00`,updateTime:`2026-01-06 11:20:00`}]),f=h([{id:`doc_001`,name:`水预算计算手册.pdf`,description:`水预算计算的详细方法和示例`,fileType:`pdf`,size:2048576,uploadTime:`2026-01-08 10:45:00`,version:1,knowledgeBaseId:`kb_001`},{id:`doc_002`,name:`水资源规划案例.docx`,description:`某地区水资源规划的实际案例分析`,fileType:`docx`,size:1536e3,uploadTime:`2026-01-08 14:20:00`,version:1,knowledgeBaseId:`kb_001`},{id:`doc_003`,name:`水资源配置模型.xlsx`,description:`水资源配置的数学模型和计算工具`,fileType:`xlsx`,size:3072e3,uploadTime:`2026-01-07 10:30:00`,version:1,knowledgeBaseId:`kb_002`}]),D=h(``),O=h(!1),k=p({name:``,description:``,domain:`hydrology`}),A=h(!1),j=h(null),M=p({documentName:``,description:``}),N=h([]),P=h(!1),F=c(()=>f.value.filter(e=>e.knowledgeBaseId===j.value?.id)),I=c(()=>D.value?l.value.filter(e=>e.name.includes(D.value)||e.description.includes(D.value)||e.domain.includes(D.value)):l.value),L=()=>{O.value=!0},R=()=>{if(!k.name.trim()){u.warning(`请输入知识库名称`);return}let e={id:`kb_${Date.now()}`,name:k.name.trim(),description:k.description.trim(),domain:k.domain,documentCount:0,status:`enabled`,createTime:new Date().toLocaleString(),updateTime:new Date().toLocaleString()};l.value.push(e),O.value=!1,u.success(`知识库创建成功`),k.name=``,k.description=``,k.domain=`hydrology`},z=e=>{j.value=e,P.value=!0},B=e=>{j.value=e,A.value=!0},V=e=>{N.value=[e]},H=()=>{u.error(`文件大小不能超过10MB`)},U=()=>{if(!j.value)return;if(N.value.length===0){u.warning(`请选择文件`);return}if(!M.documentName.trim()){u.warning(`请输入文档名称`);return}let e=N.value[0],t={id:`doc_${Date.now()}`,name:M.documentName.trim(),description:M.description.trim(),fileType:e.raw.type.split(`/`)[1],size:e.raw.size,uploadTime:new Date().toLocaleString(),version:1,knowledgeBaseId:j.value.id};f.value.push(t);let n=l.value.findIndex(e=>e.id===j.value.id);n!==-1&&(l.value[n].documentCount++,l.value[n].updateTime=new Date().toLocaleString()),u.success(`文档上传成功`),W()},W=()=>{A.value=!1,N.value=[],M.documentName=``,M.description=``},G=e=>{u.info(`文档下载功能开发中...`)},K=e=>{s.confirm(`确定要删除文档"${e.name}"吗？`,`提示`,{confirmButtonText:`确定`,cancelButtonText:`取消`,type:`warning`}).then(()=>{let t=f.value.findIndex(t=>t.id===e.id);if(t!==-1){f.value.splice(t,1);let n=l.value.findIndex(t=>t.id===e.knowledgeBaseId);n!==-1&&(l.value[n].documentCount--,l.value[n].updateTime=new Date().toLocaleString()),u.success(`文档删除成功`)}}).catch(()=>{})},q=e=>{let t=e.status===`enabled`?`禁用`:`启用`;s.confirm(`确定要${t}知识库"${e.name}"吗？`,`提示`,{confirmButtonText:`确定`,cancelButtonText:`取消`,type:t===`禁用`?`warning`:`success`}).then(()=>{let n=l.value.findIndex(t=>t.id===e.id);n!==-1&&(l.value[n].status=e.status===`enabled`?`disabled`:`enabled`,l.value[n].updateTime=new Date().toLocaleString(),u.success(`知识库已${t}成功`))}).catch(()=>{})},J=e=>{s.confirm(`确定要删除知识库"${e.name}"吗？此操作将同时删除库中的所有文档。`,`警告`,{confirmButtonText:`确定`,cancelButtonText:`取消`,type:`error`}).then(()=>{let t=l.value.findIndex(t=>t.id===e.id);t!==-1&&(l.value.splice(t,1),f.value=f.value.filter(t=>t.knowledgeBaseId!==e.id),u.success(`知识库删除成功`))}).catch(()=>{})},Y=e=>{if(e===0)return`0 B`;let t=1024,n=[`B`,`KB`,`MB`,`GB`],r=Math.floor(Math.log(e)/Math.log(t));return parseFloat((e/t**+r).toFixed(2))+` `+n[r]};return(e,s)=>{let c=a(`el-input`),l=a(`el-button`),u=a(`el-table-column`),f=a(`el-tag`),p=a(`el-table`),h=a(`el-form-item`),X=a(`el-option`),Z=a(`el-select`),Q=a(`el-form`),$=a(`el-dialog`),ne=a(`el-upload`),re=a(`el-empty`);return o(),ee(`div`,g,[d(`div`,_,[s[12]||=d(`h2`,null,`知识库管理`,-1),d(`div`,v,[i(c,{modelValue:D.value,"onUpdate:modelValue":s[0]||=e=>D.value=e,placeholder:`搜索知识库`,style:{width:`240px`,"margin-right":`12px`}},{prefix:t(()=>[...s[10]||=[d(`i`,{class:`fas fa-search`},null,-1)]]),_:1},8,[`modelValue`]),i(l,{type:`primary`,onClick:L},{default:t(()=>[...s[11]||=[d(`i`,{class:`fas fa-plus`},null,-1),r(` 创建知识库 `,-1)]]),_:1})])]),d(`div`,y,[i(p,{data:I.value,border:``,stripe:``,style:{width:`100%`}},{default:t(()=>[i(u,{prop:`id`,label:`ID`,width:`80`}),i(u,{prop:`name`,label:`知识库名称`,"min-width":`150`},{default:t(e=>[d(`span`,b,m(e.row.name),1)]),_:1}),i(u,{prop:`description`,label:`描述`,"min-width":`200`}),i(u,{prop:`domain`,label:`领域`,width:`120`}),i(u,{prop:`documentCount`,label:`文档数量`,width:`100`}),i(u,{prop:`status`,label:`状态`,width:`100`},{default:t(e=>[i(f,{type:e.row.status===`enabled`?`success`:`info`},{default:t(()=>[r(m(e.row.status===`enabled`?`启用`:`禁用`),1)]),_:2},1032,[`type`])]),_:1}),i(u,{prop:`createTime`,label:`创建时间`,width:`160`}),i(u,{prop:`updateTime`,label:`更新时间`,width:`160`}),i(u,{label:`操作`,width:`240`},{default:t(e=>[i(l,{type:`primary`,size:`small`,onClick:t=>z(e.row)},{default:t(()=>[...s[13]||=[d(`i`,{class:`fas fa-eye`},null,-1),r(` 查看 `,-1)]]),_:1},8,[`onClick`]),i(l,{size:`small`,onClick:t=>B(e.row)},{default:t(()=>[...s[14]||=[d(`i`,{class:`fas fa-upload`},null,-1),r(` 上传文档 `,-1)]]),_:1},8,[`onClick`]),i(l,{type:`warning`,size:`small`,onClick:t=>q(e.row)},{default:t(()=>[r(m(e.row.status===`enabled`?`禁用`:`启用`),1)]),_:2},1032,[`onClick`]),i(l,{type:`danger`,size:`small`,onClick:t=>J(e.row)},{default:t(()=>[...s[15]||=[d(`i`,{class:`fas fa-trash`},null,-1),r(` 删除 `,-1)]]),_:1},8,[`onClick`])]),_:1})]),_:1},8,[`data`])]),i($,{modelValue:O.value,"onUpdate:modelValue":s[5]||=e=>O.value=e,title:`创建知识库`,width:`500px`},{footer:t(()=>[d(`span`,x,[i(l,{onClick:s[4]||=e=>O.value=!1},{default:t(()=>[...s[16]||=[r(`取消`,-1)]]),_:1}),i(l,{type:`primary`,onClick:R},{default:t(()=>[...s[17]||=[r(`确定`,-1)]]),_:1})])]),default:t(()=>[i(Q,{model:k,"label-width":`100px`},{default:t(()=>[i(h,{label:`知识库名称`},{default:t(()=>[i(c,{modelValue:k.name,"onUpdate:modelValue":s[1]||=e=>k.name=e,placeholder:`请输入知识库名称`},null,8,[`modelValue`])]),_:1}),i(h,{label:`描述`},{default:t(()=>[i(c,{modelValue:k.description,"onUpdate:modelValue":s[2]||=e=>k.description=e,type:`textarea`,rows:3,placeholder:`请输入知识库描述`},null,8,[`modelValue`])]),_:1}),i(h,{label:`领域`},{default:t(()=>[i(Z,{modelValue:k.domain,"onUpdate:modelValue":s[3]||=e=>k.domain=e,placeholder:`请选择领域`},{default:t(()=>[i(X,{label:`水文学`,value:`hydrology`}),i(X,{label:`水资源管理`,value:`water_resources`}),i(X,{label:`水环境`,value:`water_environment`}),i(X,{label:`水利工程`,value:`hydraulic_engineering`})]),_:1},8,[`modelValue`])]),_:1})]),_:1},8,[`model`])]),_:1},8,[`modelValue`]),i($,{modelValue:A.value,"onUpdate:modelValue":s[8]||=e=>A.value=e,title:`上传文档 - ${j.value?.name}`,width:`500px`},{footer:t(()=>[d(`span`,S,[i(l,{onClick:W},{default:t(()=>[...s[20]||=[r(`取消`,-1)]]),_:1}),i(l,{type:`primary`,onClick:U},{default:t(()=>[...s[21]||=[r(`上传`,-1)]]),_:1})])]),default:t(()=>[i(Q,{model:M,"label-width":`100px`},{default:t(()=>[i(h,{label:`文档名称`},{default:t(()=>[i(c,{modelValue:M.documentName,"onUpdate:modelValue":s[6]||=e=>M.documentName=e,placeholder:`请输入文档名称`},null,8,[`modelValue`])]),_:1}),i(h,{label:`文档文件`},{default:t(()=>[i(ne,{action:``,"file-list":N.value,"auto-upload":!1,"on-change":V,accept:`.pdf,.doc,.docx,.txt,.md`,limit:1,"on-exceed":H},{trigger:t(()=>[i(l,{type:`primary`},{default:t(()=>[...s[18]||=[d(`i`,{class:`fas fa-folder-open`},null,-1),r(` 选择文件 `,-1)]]),_:1})]),tip:t(()=>[...s[19]||=[d(`div`,{class:`el-upload__tip`},` 支持上传PDF、Word、TXT、Markdown格式文件，大小不超过10MB `,-1)]]),_:1},8,[`file-list`])]),_:1}),i(h,{label:`文档描述`},{default:t(()=>[i(c,{modelValue:M.description,"onUpdate:modelValue":s[7]||=e=>M.description=e,type:`textarea`,rows:3,placeholder:`请输入文档描述`},null,8,[`modelValue`])]),_:1})]),_:1},8,[`model`])]),_:1},8,[`modelValue`,`title`]),i($,{modelValue:P.value,"onUpdate:modelValue":s[9]||=e=>P.value=e,title:`知识库详情 - ${j.value?.name}`,width:`800px`},{default:t(()=>[d(`div`,C,[d(`div`,w,[d(`h3`,null,m(j.value?.name),1),d(`p`,T,m(j.value?.description),1),d(`div`,E,[i(f,{size:`small`},{default:t(()=>[r(`领域：`+m(j.value?.domain),1)]),_:1}),i(f,{size:`small`},{default:t(()=>[r(`文档数：`+m(j.value?.documentCount),1)]),_:1}),i(f,{size:`small`},{default:t(()=>[r(m(j.value?.status===`enabled`?`启用`:`禁用`),1)]),_:1}),i(f,{size:`small`},{default:t(()=>[r(`创建时间：`+m(j.value?.createTime),1)]),_:1}),i(f,{size:`small`},{default:t(()=>[r(`更新时间：`+m(j.value?.updateTime),1)]),_:1})])]),d(`div`,te,[s[24]||=d(`h4`,null,`文档列表`,-1),F.value.length>0?(o(),n(p,{key:0,data:F.value,border:``,stripe:``,style:{width:`100%`}},{default:t(()=>[i(u,{prop:`id`,label:`ID`,width:`80`}),i(u,{prop:`name`,label:`文档名称`,"min-width":`180`}),i(u,{prop:`description`,label:`描述`,"min-width":`200`}),i(u,{prop:`fileType`,label:`文件类型`,width:`100`}),i(u,{prop:`size`,label:`文件大小`,width:`100`},{default:t(e=>[r(m(Y(e.row.size)),1)]),_:1}),i(u,{prop:`uploadTime`,label:`上传时间`,width:`160`}),i(u,{prop:`version`,label:`版本`,width:`80`}),i(u,{label:`操作`,width:`150`},{default:t(e=>[i(l,{type:`primary`,size:`small`,onClick:t=>G(e.row)},{default:t(()=>[...s[22]||=[d(`i`,{class:`fas fa-download`},null,-1),r(` 下载 `,-1)]]),_:1},8,[`onClick`]),i(l,{type:`danger`,size:`small`,onClick:t=>K(e.row)},{default:t(()=>[...s[23]||=[d(`i`,{class:`fas fa-trash`},null,-1),r(` 删除 `,-1)]]),_:1},8,[`onClick`])]),_:1})]),_:1},8,[`data`])):(o(),n(re,{key:1,description:`暂无文档`}))])])]),_:1},8,[`modelValue`,`title`])])}}}),[[`__scopeId`,`data-v-4bcfac6b`]]);export{D as default};
import{_ as e,a as t,b as n,d as r,f as i,g as a,h as o,i as s,l as c,m as l,p as u,s as d,t as f,u as p,v as m,x as h,y as g}from"./index-M0WXdtCa.js";var _={class:`conversation-container`},v={class:`conversation-layout`},y={class:`conversation-sidebar`},b={class:`sidebar-header`},x={class:`conversation-list`},S=[`onClick`],C={class:`conversation-item-title`},w={class:`conversation-item-time`},T={class:`conversation-item-preview`},E={class:`conversation-main`},D={class:`conversation-header`},O={class:`header-actions`},k={class:`conversation-area`},A={class:`messages-list`},j={class:`message-content`},M={class:`message-time`},N={key:0,class:`message-actions`},P={key:0,class:`loading-message`},F={class:`input-area`},I={class:`input-actions`},L=f(u({__name:`Conversation`,setup(u){let f=m([{id:`conv_001`,title:`水预算基本概念`,createTime:new Date(Date.now()-36e5),updateTime:new Date(Date.now()-36e5),messages:[{id:`msg_001`,role:`system`,content:`您好，我是水预算助手，请问有什么可以帮助您的？`,timestamp:new Date(Date.now()-36e5)},{id:`msg_002`,role:`user`,content:`请介绍一下水预算的基本概念`,timestamp:new Date(Date.now()-35e5)},{id:`msg_003`,role:`system`,content:`水预算是指对水资源的收支进行预测和规划的过程，包括降水、蒸发、径流等水文要素的计算和分析，以及水资源的合理配置和利用。`,timestamp:new Date(Date.now()-34e5)}]}]),L=g(`conv_001`),R=g(`水预算基本概念`),z=g(f[0].messages),B=g(``),V=g(!1),H=e=>new Date(e).toLocaleTimeString(`zh-CN`,{hour:`2-digit`,minute:`2-digit`}),U=e=>{let t=new Date,n=Math.floor((t.getTime()-new Date(e).getTime())/(1e3*60*60*24));return n===0?`今天`:n===1?`昨天`:n<7?`${n}天前`:new Date(e).toLocaleDateString(`zh-CN`,{year:`numeric`,month:`2-digit`,day:`2-digit`})},W=e=>{if(e.length===0)return`无消息`;let t=e[e.length-1],n=t.content;return n.length>30&&(n=n.substring(0,30)+`...`),`${t.role===`user`?`我: `:`系统: `}${n}`},G=()=>{if(!B.value.trim())return;let e={id:`msg_${Date.now()}`,role:`user`,content:B.value,timestamp:new Date};z.value.push(e),B.value=``,V.value=!0,setTimeout(()=>{let e={id:`msg_${Date.now()}`,role:`system`,content:`这是系统的模拟回复。在实际应用中，这里会调用水预算大模型生成真实回复。`,timestamp:new Date};z.value.push(e),V.value=!1;let t=f.find(e=>e.id===L.value);t&&(t.updateTime=new Date)},1e3)},K=(e,t)=>{console.log(`评价消息`,e,t)},q=()=>{let e=f.find(e=>e.id===L.value);e&&(e.title=prompt(`请输入新的对话标题`,e.title)||e.title,R.value=e.title)},J=()=>{let e=f.findIndex(e=>e.id===L.value);e>-1&&(f.splice(e,1),f.length>0?X(f[0].id):Y())},Y=()=>{let e={id:`conv_${Date.now()}`,title:`新对话`,createTime:new Date,updateTime:new Date,messages:[{id:`msg_${Date.now()}`,role:`system`,content:`您好，我是水预算助手，请问有什么可以帮助您的？`,timestamp:new Date}]};f.push(e),X(e.id)},X=e=>{L.value=e;let t=f.find(t=>t.id===e);t&&(R.value=t.title,z.value=t.messages)};return(u,m)=>{let g=a(`el-button`),Z=a(`el-rate`),Q=a(`el-skeleton`),$=a(`el-input`);return l(),p(`div`,_,[d(`div`,v,[d(`div`,y,[d(`div`,b,[m[2]||=d(`h3`,null,`对话历史`,-1),i(g,{type:`primary`,size:`small`,onClick:Y,plain:``},{default:e(()=>[...m[1]||=[d(`i`,{class:`fas fa-plus`},null,-1),r(` 新对话 `,-1)]]),_:1})]),d(`div`,x,[(l(!0),p(t,null,o(f,e=>(l(),p(`div`,{key:e.id,class:n([`conversation-item`,{active:e.id===L.value}]),onClick:t=>X(e.id)},[d(`div`,C,h(e.title),1),d(`div`,w,h(U(e.updateTime)),1),d(`div`,T,h(W(e.messages)),1)],10,S))),128))])]),d(`div`,E,[d(`div`,D,[d(`h2`,null,h(R.value),1),d(`div`,O,[i(g,{type:`text`,onClick:q},{default:e(()=>[...m[3]||=[d(`i`,{class:`fas fa-edit`},null,-1),r(` 重命名 `,-1)]]),_:1}),i(g,{type:`text`,onClick:J},{default:e(()=>[...m[4]||=[d(`i`,{class:`fas fa-trash`},null,-1),r(` 删除 `,-1)]]),_:1})])]),d(`div`,k,[d(`div`,A,[(l(!0),p(t,null,o(z.value,e=>(l(),p(`div`,{key:e.id,class:n([`message-item`,{"user-message":e.role===`user`,"system-message":e.role===`system`}])},[d(`div`,j,h(e.content),1),d(`div`,M,h(H(e.timestamp)),1),e.role===`system`?(l(),p(`div`,N,[i(Z,{modelValue:e.rating,"onUpdate:modelValue":t=>e.rating=t,max:5,size:`small`,onChange:t=>K(e.id,t)},null,8,[`modelValue`,`onUpdate:modelValue`,`onChange`])])):c(``,!0)],2))),128)),V.value?(l(),p(`div`,P,[i(Q,{rows:3,animated:``})])):c(``,!0)]),d(`div`,F,[i($,{modelValue:B.value,"onUpdate:modelValue":m[0]||=e=>B.value=e,type:`textarea`,rows:4,placeholder:`请输入您的问题...`,onKeyup:s(G,[`enter`,`native`]),resize:`none`},null,8,[`modelValue`]),d(`div`,I,[i(g,{type:`primary`,onClick:G},{default:e(()=>[...m[5]||=[d(`i`,{class:`fas fa-paper-plane`},null,-1),r(` 发送 `,-1)]]),_:1})])])])])])])}}}),[[`__scopeId`,`data-v-3b48f45b`]]);export{L as default};